<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2. Data Processing Algorithms in MOSAIC &#8212; MOSAIC 2.0b1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Getting Started" href="GettingStarted.html" />
    <link rel="prev" title="1. Introduction" href="Introduction.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

	<script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-42404149-54&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
	</script>	

	<meta name="theme-color" content="#283593">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/icon_48.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>2.0b1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../latex/MOSAIC.pdf">Download PDF</a></li>
                <li><a href="mailingList.html">Mailing List</a></li>
                <li><a href="//github.com/usnistgov/mosaic">Develop</a></li>
                <li><a href="//github.com/usnistgov/mosaic/issues">Issue Tracker</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">1. Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Data Processing Algorithms in <em>MOSAIC</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">3. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="GraphicalInterface.html">4. <em>MOSAIC</em> GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebInterface.html">5. <em>MOSAIC</em> WEB</a></li>
<li class="toctree-l1"><a class="reference internal" href="settingsFile.html">6. Settings File</a></li>
<li class="toctree-l1"><a class="reference internal" href="DatabaseStructure.html">7. Database Structure and Query Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="ScriptingandAdvancedFeatures.html">8. Scripting and Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="Extend.html">9. Extend <em>MOSAIC</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="PublicationFigures.html">10. Publication Quality Figures</a></li>
<li class="toctree-l1"><a class="reference internal" href="AdvancedAnalysis.html">11. Advanced Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Addons.html">12. Addons</a></li>
<li class="toctree-l1"><a class="reference internal" href="DeveloperTools.html">13. Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="apidocs.html">14. API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="References.html">15. Bibliography</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="data-processing-algorithms-in-projname">
<span id="algorithms-page"></span><h1>2. Data Processing Algorithms in <em>MOSAIC</em><a class="headerlink" href="#data-processing-algorithms-in-projname" title="Permalink to this headline">¶</a></h1>
<p>There are three primary algorithms available in <em>MOSAIC</em> to process time-series data from single-molecule nanopore experiments. Fitting-based approaches are outlined in the <a class="reference internal" href="Introduction.html#introduction-page"><span class="std std-ref">Introduction</span></a>, are implemented in <em>MOSAIC</em> using two separate algorithms, i) StepResponseAnalysis is used for events that exhibit a single state, and ii) MultistateAnalysis for <em>N</em>-state events. In addition, the CUSUM algorithm is available for <em>N</em>-state events.</p>
<div class="section" id="adept-2-state">
<span id="stepresponse-page"></span><h2>2.1. ADEPT 2-State<a class="headerlink" href="#adept-2-state" title="Permalink to this headline">¶</a></h2>
<p>This algorithm limits the generalized algorithm for state-detection <a class="reference internal" href="References.html#balijepalli-2014ft" id="id1">[BEC+14]</a> to cases with a single state as seen in the figure below. This simplified approach speeds up the analysis considerably and is appropriate to use for many applications, for example the detection of PEG, small molecules, DNA homopolymers, etc. The <code class="xref py py-class docutils literal notranslate"><span class="pre">adept2State</span></code> class uses a simplified form of the expression for the ionic current across a nanopore as shown below. Settings that control the fit are defined through the settings file and are described in more detail in the <a class="reference internal" href="settingsFile.html#algorithm-settings-sec"><span class="std std-ref">Optimizing Settings</span></a> section. This functional form is fit to a time-series from a single event to recover optimal parameters for the mdoel.</p>
<div class="math notranslate nohighlight">
\[i(t)=i_0 + a \left[ \left(e^{-(t+\mu_1)/\tau} -1\right) H\left(t-\mu_1\right)  + \left(1- e^{-(t+\mu_2)/\tau} \right)H\left(t-\mu_2\right) \right]\]</div>
<p>This simplification speeds up the analysis for two state events like the PEG event in the figure below. The figure shows the results of the fit (or meta-data) superimposed on the time-series of a single event.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/StepResponse.png"><img alt="../_images/StepResponse.png" src="../_images/StepResponse.png" style="width: 50%;" /></a>
</div>
<div class="section" id="algorithm-settings">
<h3>2.1.1. Algorithm Settings<a class="headerlink" href="#algorithm-settings" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="metadata-output">
<h3>2.1.2. Metadata Output<a class="headerlink" href="#metadata-output" title="Permalink to this headline">¶</a></h3>
<p>Meta-data for individual events generated by <code class="xref py py-class docutils literal notranslate"><span class="pre">adept2State</span></code> can be queried using <a class="reference external" href="http://www.sqlite.org/">SQLite</a> as described in the <a class="reference internal" href="DatabaseStructure.html#database-page"><span class="std std-ref">Database Structure and Query Syntax</span></a> section. A list of meta-data stored by the step response algorithm is given below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="25%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Column Name</strong></th>
<th class="head"><strong>Column Type</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first">recIDX</p>
<p>ProcessingStatus</p>
<p>OpenChCurrent</p>
<p>BlockedCurrent</p>
<p>EventStart</p>
<p>EventEnd</p>
<p>BlockDepth</p>
<p>ResTime</p>
<p>RCConstant1</p>
<p>RCConstant2</p>
<p>AbsEventStart</p>
<p>ReducedChiSquared</p>
<p>ProcessTime</p>
<p class="last">TimeSeries</p>
</td>
<td><p class="first">INTEGER</p>
<p>TEXT</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p class="last">REAL_LIST</p>
</td>
<td><p class="first">Record index.</p>
<p>Status of the analysis.</p>
<p>Open channel current in pA.</p>
<p>Blocked state current in pA.</p>
<p>Event start in ms.</p>
<p>Event end in ms.</p>
<p>BlockedCurrent/OpenChCurrent.</p>
<p>EventEnd-EventStart in ms.</p>
<p>Downstroke RC constant in ms.</p>
<p>Upstroke RC constant in ms.</p>
<p>Global event start time in ms.</p>
<p>Reduced Chi-squared of fit.</p>
<p>Event processing time in ms.</p>
<p class="last">(OPTIONAL) Event time-series.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="adept">
<span id="multistate-page"></span><h2>2.2. ADEPT<a class="headerlink" href="#adept" title="Permalink to this headline">¶</a></h2>
<p>The multistate algorithm implements the  general case for identifying states in nanopore data <a class="reference internal" href="References.html#balijepalli-2014ft" id="id2">[BEC+14]</a>. The general form of the equation used in this algorithm is shown below, where <em>N</em> is the number of states. This functional form is fit to a time-series from a single event to recover optimal parameters for the mdoel.</p>
<div class="math notranslate nohighlight">
\[i(t)=i_0 + \sum_{j=1}^{N} a_j\left(1-e^{-\left(t-\mu_j\right)/\tau_j}\right) H\left(t-\mu_j\right)\]</div>
<p>Settings that control the fit are defined through the settings file and are described in more detail in the <a class="reference internal" href="settingsFile.html#algorithm-settings-sec"><span class="std std-ref">Optimizing Settings</span></a> section. Upon successfully fitting the model to an event, <code class="xref py py-class docutils literal notranslate"><span class="pre">adept</span></code> generates meta-data the describes the individual states in the event. A representative example of one such event is shown in the figure below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Multistate.png"><img alt="../_images/Multistate.png" src="../_images/Multistate.png" style="width: 50%;" /></a>
</div>
<div class="section" id="id3">
<h3>2.2.1. Algorithm Settings<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id4">
<h3>2.2.2. Metadata Output<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">adept</span></code> algorithm outputs meta-data that characterizes every processed event. Similar to the <a class="reference internal" href="stepResponse.html#stepresponse-page"><span class="std std-ref">ADEPT 2-State</span></a> algorithm, this information is stored in a <a class="reference external" href="http://www.sqlite.org/">SQLite</a> database and is available for further processing (see <a class="reference internal" href="DatabaseStructure.html#database-page"><span class="std std-ref">Database Structure and Query Syntax</span></a>). Notably, the data output by <code class="xref py py-class docutils literal notranslate"><span class="pre">adept</span></code> differs from <code class="xref py py-class docutils literal notranslate"><span class="pre">adept2State</span></code> in one important way. Because the number of states (<em>NStates</em>) detected in each event is not pre-determined, key meta-data (e.g. <em>BlockDepth</em>, <em>EventDelay</em>, etc.) are stored as arrays of real numbers with length equal to <em>NStates</em>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="20%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Column Name</strong></th>
<th class="head"><strong>Column Type</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first">recIDX</p>
<p>ProcessingStatus</p>
<p>OpenChCurrent</p>
<p>NStates</p>
<p>CurrentStep</p>
<p>BlockDepth</p>
<p>EventStart</p>
<p>EventEnd</p>
<p>EventDelay</p>
<p>StateResTime</p>
<p>ResTime</p>
<p>RCConstant</p>
<p>AbsEventStart</p>
<p>ReducedChiSquared</p>
<p>ProcessTime</p>
<p class="last">TimeSeries</p>
</td>
<td><p class="first">INTEGER</p>
<p>TEXT</p>
<p>REAL</p>
<p>INTEGER</p>
<p>REAL_LIST</p>
<p>REAL_LIST</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL_LIST</p>
<p>REAL_LIST</p>
<p>REAL</p>
<p>REAL_LIST</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p class="last">REAL_LIST</p>
</td>
<td><p class="first">Record index.</p>
<p>Status of the analysis.</p>
<p>Open channel current in pA.</p>
<p>Number of detected states.</p>
<p>Blocked current steps in pA.</p>
<p>BlockedCurrent/OpenChCurrent for each state.</p>
<p>Event start in ms.</p>
<p>Event end in ms.</p>
<p>Start time of each state in ms.</p>
<p>Residence time of each state in ms.</p>
<p>EventEnd-EventStart in ms.</p>
<p>System RC constant in ms.</p>
<p>Global event start time in ms.</p>
<p>Reduced Chi-squared of fit.</p>
<p>Event processing time in ms.</p>
<p class="last">(OPTIONAL) Event time-series.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="cusum">
<span id="cusumlevel-page"></span><h2>2.3. CUSUM+<a class="headerlink" href="#cusum" title="Permalink to this headline">¶</a></h2>
<p>The CUSUM algorithm (used by OpenNanopore for example) <a class="reference internal" href="References.html#raillon-2012is" id="id5">[RGG+12]</a> is available in <em>MOSAIC</em>. In contrast with other algorithms available in <em>MOSAIC</em>, this approach does not leverage system information in the analysis. This however results in a faster estimation of single- and multi-level events, compared with <a class="reference internal" href="stepResponse.html#stepresponse-page"><span class="std std-ref">ADEPT 2-State</span></a> and <a class="reference internal" href="multiState.html#multistate-page"><span class="std std-ref">ADEPT</span></a>. You can read about the CUSUM algorithm <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2012/NR/c2nr30951c#!divAbstract">here</a>.</p>
<p>Some known issues with CUSUM:</p>
<blockquote>
<div><ol class="arabic simple">
<li>If the duration of a sub-event is shorter than a five RC constants, the averaging will underestimate the extent of the current change. For longer events, CUSUM should achieve very similar output to the fitting employed elsewhere in <em>MOSAIC</em>.</li>
<li>CUSUM assumes an instantaneous transition between current states. As a result, if the RC rise time of the system is large, CUSUM can trigger and detect intermediate states. This can usually be mitigated by optimizing the algorithm sensitivity settings.</li>
<li>If an event is very long, CUSUM will detect a state transistion even if there is no real change, leading to an artificially high number of states. This is a consequence of false positives from using a statistical t-test. In some cases this can be mitigated by reducing the sensitivity.</li>
</ol>
</div></blockquote>
<p>Settings that control the algorithm are defined through the settings file, as described the <a class="reference internal" href="settingsFile.html#algorithm-settings-sec"><span class="std std-ref">Optimizing Settings</span></a> section. Upon successfully analyzing an event, <code class="xref py py-class docutils literal notranslate"><span class="pre">cusumPlus</span></code> generates meta-data the describes the individual states in the event. A representative example of one such event is shown in the figure below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/CUSUM.png"><img alt="../_images/CUSUM.png" src="../_images/CUSUM.png" style="width: 50%;" /></a>
</div>
<div class="section" id="id6">
<h3>2.3.1. Algorithm Settings<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id7">
<h3>2.3.2. Metadata Output<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">cusumPlus</span></code> algorithm outputs meta-data that characterizes every processed event. Similar to the <a class="reference internal" href="multiState.html#multistate-page"><span class="std std-ref">ADEPT</span></a> algorithm, this information is stored in a <a class="reference external" href="http://www.sqlite.org/">SQLite</a> database and is available for further processing (see <a class="reference internal" href="DatabaseStructure.html#database-page"><span class="std std-ref">Database Structure and Query Syntax</span></a>).</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="20%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Column Name</strong></th>
<th class="head"><strong>Column Type</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first">recIDX</p>
<p>ProcessingStatus</p>
<p>OpenChCurrent</p>
<p>NStates</p>
<p>CurrentStep</p>
<p>BlockDepth</p>
<p>EventStart</p>
<p>EventEnd</p>
<p>EventDelay</p>
<p>StateResTime</p>
<p>ResTime</p>
<p>AbsEventStart</p>
<p>ProcessTime</p>
<p class="last">TimeSeries</p>
</td>
<td><p class="first">INTEGER</p>
<p>TEXT</p>
<p>REAL</p>
<p>INTEGER</p>
<p>REAL_LIST</p>
<p>REAL_LIST</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL_LIST</p>
<p>REAL_LIST</p>
<p>REAL</p>
<p>REAL</p>
<p>REAL</p>
<p class="last">REAL_LIST</p>
</td>
<td><p class="first">Record index.</p>
<p>Status of the analysis.</p>
<p>Open channel current in pA.</p>
<p>Number of detected states.</p>
<p>Blocked current steps in pA.</p>
<p>BlockedCurrent/OpenChCurrent for each state.</p>
<p>Event start in ms.</p>
<p>Event end in ms.</p>
<p>Start time of each state in ms.</p>
<p>Residence time of each state in ms.</p>
<p>EventEnd-EventStart in ms.</p>
<p>Global event start time in ms.</p>
<p>Event processing time in ms.</p>
<p class="last">(OPTIONAL) Event time-series.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<!-- 
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.<br/>
    </p>
  </div>
</footer> -->
<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<div class="footer" style="vertical-align: center" align="center">
		<table width="90%" style="vertical-align: center">
			<col width=40%>
			<col width=60%>
			<tr>
				<td align="left">
					<a href="Developers.html"><small><em>MOSAIC Developers</em></small></a> |
					<a href="http://www.nist.gov/pml/div683/grp06/abalijepalli.cfm"><small><em>Contact</em></small></a> |
					<a href="Disclaimer.html"><small><em>Terms of Use</em></small></a>
				</td>
			<!-- </tr>
			<tr> -->
				<td align="right">
					<a target="_blank" href="http://www.nist.gov/public_affairs/privacy.cfm#privpolicy"><small>Privacy Policy</small></a> |
					<a target="_blank" href="http://www.nist.gov/public_affairs/privacy.cfm#secnot"><small>Security Notice</small></a> |
					<a href="http://www.nist.gov/public_affairs/privacy.cfm#accesstate"><small>Accessibility Statement</small></a> |
					<a target="_blank" href="mailto:data@nist.gov?subject=Feedback%20on%20Web%20Site%20Template"><small>Send feedback</small></a>
					<br/>
				</td>
			</tr>
		</table>

		<br />
		<a href="http://www.nist.gov/"><small><em>National Institute of Standards and Technology</em></small></a>
		<!-- <a href="http://www.nist.gov"><img src="_static/nist_logo.png" width="30%" alt="National Institute of Standards and Technology"></a> -->

</div>

  </body>
</html>